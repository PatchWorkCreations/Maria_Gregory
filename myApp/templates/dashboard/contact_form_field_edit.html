{% extends "dashboard/base.html" %}

{% block title %}{% if field.id %}Edit{% else %}Add{% endif %} Form Field{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-navy-900 mb-2">{% if field.id %}Edit{% else %}Add{% endif %} Form Field</h1>
    <p class="text-gray-600">Manage contact form field</p>
</div>

<form method="post" class="bg-white rounded-lg shadow p-6">
    {% csrf_token %}
    
    <div class="mb-6">
        <label class="block text-gray-700 font-medium mb-2">Label</label>
        <input type="text" name="label" value="{{ field.label|default:'' }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-500" required placeholder="e.g., Name, Email">
    </div>
    
    <div class="mb-6">
        <label class="block text-gray-700 font-medium mb-2">Field Type</label>
        <select name="field_type" id="fieldType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-500">
            <option value="text" {% if field.field_type == 'text' %}selected{% endif %}>Text</option>
            <option value="email" {% if field.field_type == 'email' %}selected{% endif %}>Email</option>
            <option value="textarea" {% if field.field_type == 'textarea' %}selected{% endif %}>Textarea</option>
            <option value="select" {% if field.field_type == 'select' %}selected{% endif %}>Select (Dropdown)</option>
            <option value="checkbox" {% if field.field_type == 'checkbox' %}selected{% endif %}>Checkbox</option>
        </select>
    </div>
    
    <div class="mb-6">
        <label class="block text-gray-700 font-medium mb-2">Placeholder Text</label>
        <input type="text" name="placeholder" value="{{ field.placeholder|default:'' }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-500" placeholder="e.g., Enter your name">
    </div>
    
    <div class="mb-6" id="optionsField" style="display: {% if field.field_type == 'select' or field.field_type == 'checkbox' %}block{% else %}none{% endif %};">
        <label class="block text-gray-700 font-medium mb-2">Options (one per line)</label>
        <textarea name="options_text" id="optionsText" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-500" placeholder="Option 1&#10;Option 2&#10;Option 3">{% if field.options %}{% for option in field.options %}{{ option }}{% if not forloop.last %}&#10;{% endif %}{% endfor %}{% endif %}</textarea>
        <p class="text-sm text-gray-500 mt-1">Enter one option per line (for select and checkbox fields)</p>
        <input type="hidden" name="options" id="optionsJson">
    </div>
    
    <div class="mb-6">
        <label class="flex items-center">
            <input type="checkbox" name="is_required" {% if field.is_required %}checked{% endif %} class="mr-2">
            <span class="text-gray-700 font-medium">Required Field</span>
        </label>
    </div>
    
    <div class="mb-6">
        <label class="block text-gray-700 font-medium mb-2">Display Order</label>
        <input type="number" name="sort_order" value="{{ field.sort_order|default:0 }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-500">
        <p class="text-sm text-gray-500 mt-1">Lower numbers appear first</p>
    </div>
    
    <div class="mb-6">
        <label class="flex items-center">
            <input type="checkbox" name="is_active" {% if field.is_active or not field.id %}checked{% endif %} class="mr-2">
            <span class="text-gray-700 font-medium">Active (show on website)</span>
        </label>
    </div>
    
    <div class="flex gap-4">
        <button type="submit" class="bg-navy-900 hover:bg-navy-800 text-white px-6 py-3 rounded-lg transition-colors">
            <i class="fas fa-save mr-2"></i>Save
        </button>
        <a href="{% url 'dashboard:contact_form_fields_list' %}" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-lg transition-colors">
            Cancel
        </a>
    </div>
</form>

{% block extra_js %}
<script>
    document.getElementById('fieldType').addEventListener('change', function() {
        const optionsField = document.getElementById('optionsField');
        if (this.value === 'select' || this.value === 'checkbox') {
            optionsField.style.display = 'block';
        } else {
            optionsField.style.display = 'none';
        }
    });
    
    document.querySelector('form').addEventListener('submit', function(e) {
        const optionsText = document.getElementById('optionsText').value;
        const options = optionsText.split('\n').filter(opt => opt.trim() !== '').map(opt => opt.trim());
        document.getElementById('optionsJson').value = JSON.stringify(options);
    });
</script>
{% endblock %}
{% endblock %}


